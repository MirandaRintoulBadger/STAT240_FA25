---
title: "week5_live_join_pivot"
output: html_document
date: "2025-09-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error = T, warning = T)

library(tidyverse)
```

# Datasets

```{r}
drinks = tibble(
  Row = 1:4,
  Drink = c("Milk Tea", "Espresso", "Latte", "Espresso"),
  Cafe = c("Happy Tea", "Daily Grind", "Daily Grind", "Bev's Beverages"),
  Price = c(4, 2, 3, 2)
)


discounts = tibble(
  Row = 1:3,
  Coupon = c("25%", "50%", "5%"),
  Cafe = c("Happy Tea", "Daily Grind", "The Roast")
)

```


```{r}
drinks
discounts
```

# Joining two datasets

## join functions: ...._join(x, y, by = join_by(col))

### mutating joins: these functions add columns from both datasets to the final result

- left_join(): 

```{r}
left_join(drinks, discounts, by = join_by("Cafe"))
```

- right_join(): 

```{r}
right_join(drinks, discounts, by = join_by("Cafe"))
```


```{r}
left_join(discounts, drinks, by = join_by("Cafe"))
```

- full_join():

```{r}
full_join(drinks, discounts, by = join_by("Cafe"))
```

- inner_join():

```{r}
inner_join(drinks, discounts, by = join_by("Cafe"))
```

### filtering joins: these join funcions filter out rows fro the X dataset depending on the Y dataset.

- anti_join():

```{r}
anti_join(drinks, discounts, by = "Cafe")
```

- semi_join(): 
```{r}
semi_join(drinks, discounts, by = "Cafe")
```

## join functions without the `by` argument 


```{r}
left_join(drinks, discounts)
```

```{r}
full_join(drinks, discounts)
```



```{r}
anti_join(drinks, discounts)
```

```{r}
band_members
band_instruments

left_join(band_members, band_instruments)
```

Different named columns

```{r}
drinks %>% rename(Location = Cafe) %>% left_join(discounts, by = join_by(Location == Cafe))
```

# Pivoting

```{r}
players = tibble(
  player = c("Erling Haaland", "Kevin De Bruyne"),
  goals = c(36, 7),
  assists = c(8, 16),
  games = c(35, 32)
)

players
```

- `pivot_longer()`:

```{r}
players %>% select(-goals)


pivot_longer(players, c(goals, assists, games), names_to = "information", values_to = "scores")

pivot_longer(players, -player, names_to = "information", values_to = "scores")

pivot_longer(players, goals:games, names_to = "information", values_to = "scores")
```

```{r}
table1

table1 %>% pivot_longer(cases:population)

table1 %>% pivot_longer(-c(country, year))

table1 %>% pivot_longer(year:population)

table1 %>% mutate(case = as.character(cases), pop = as.character(population)) %>% select(-c(cases, population)) %>% pivot_longer(c(country, case:pop)) # country can not be pivoted since a charachter vector
```

- `pivot_wider()`:

```{r}
players_long = pivot_longer(players, goals:games, names_to = "information", values_to = "scores")

players_long %>% pivot_wider(names_from = information, values_from = scores)
```

```{r}
pivot_longer(players, c(goals, assists, games)) %>% pivot_wider()
```

```{r}
pivot_longer(players, c(goals, assists, games))


players %>% relocate(goals, games) %>% pivot_longer(-player)
```

```{r}
table2 %>% rename(name = type, value = count) %>% pivot_wider()

table2 %>% pivot_wider(names_from = type, values_from = count)
```

```{r}
table1
```





