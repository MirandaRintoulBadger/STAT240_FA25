---
title: "Discussion 6"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = TRUE, message = FALSE,
                      error = TRUE)

library(tidyverse)
```

# Preliminaries

- This file should be in `STAT240/discussion/ds06`.
- This assignment should be completed in your discussion groups, which can be found on the "People" tab on Canvas.

The goal of today's discussion will be to practice calculating unexpectedly complex probabilities from a simple game.  It will also cover concepts of random variables and expectation.


Today's discussion is based on the game of "Greed".  Players take turns rolling a regular six-sided die.  The value of each roll is added to your score, the sum of your previous rolls.  You can roll the die up to 8 times, for a maximum score of 48.

However, if you roll a 1, you "greed out".  Your score goes to 0 and you are out of the game! You can choose to stop rolling the die at any point if you are happy with your current score.


# Problem 1
#### (approx. 5 minutes)

Start by playing a quick round of the game with your group.  If you don't have a die, you can use an online dice roller or simulate a die roll in R:

```{r}
sample(1:6, size = 1)
```


# Problem 2
#### (approx. 15 minutes)

Find the following probabilities about playing Greed.

(a) What is the probability that a player manages to roll the die all 8 times without ever rolling a 1?

(b) A player has successfully managed to roll 7 times.  What is the probability that they "greed out" on the eigth roll?

(c) Tony has decided to stop rolling after getting a score of 12.  His rival Tammy currently has 9 points.  What is the probability that she beats Tony's score in either one or two more rolls?


# Problem 3
#### (approx. 10 minutes)

Greedy Gretchen will always choose to roll the die if she is able to. Let $X$ refer to Gretchen's final score. Answer the following questions about random variable $X$.  Recall that the game ends with a final score of 0 whenever a 1 is rolled.

(a) Is $X$ discrete or continuous?

(b) What are all of the possible values of $X$?

(c) What is $P(X = 0)$?


# Problem 4
#### (approx. 10 minutes)

Think about what the histogram of the distribution of $X$ would look like.  Make a rough, intuitive sketch of the probabilities of $X$, without doing any calculation.

Similarly, make an intuitive guess about the expected value $E(X)$.  Would it be close to 0? Close to the maximum of $X$? Close to the middle?

**After** thinking through this on your own, change `eval=FALSE` in the chunk below to `eval=TRUE` to check your intuition.  This chunk simulates 10000 theoretical scores for Greedy Gretchen, plots them in a histogram, and calculates their average.

```{r, eval=FALSE}
# This code is outside the scope of 240,
# but feel free to play with it if you wish

iters <- 10000
scores <- numeric(iters)

set.seed(240)
for(i in 1:iters){
  for(rolls in 1:8){
    this_roll <- sample(1:6, size = 1)
    
    if(this_roll == 1){
      scores[i] <- 0
      break
      
    } else {
      scores[i] <- scores[i] + this_roll
    }
  }
}

ggplot(data = tibble(scores), aes(x = scores)) +
  geom_histogram(binwidth = 4, boundary = 0,
                 fill = "blue") +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = mean(scores), linetype = 2) +
  annotate("text", x = 19, y = 5000, label = "Average of Simulated Scores") +
  labs(title = "Simulated Distribution of X",
       x = "Score",
       y = "")

```


# Problem 5
#### (approx. 5 minutes)

Let random variable $Y$ refer to the count of the number of times Greedy Gretchen rolls a 3 when she plays the game.  Is $Y$ a binomial random variable? Explain your answer with the BINS assumptions.













