---
title: "Homework 7"
output: html_document
---

```{css, echo = F}
.soln {
background-color: #E6E6FA;
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
                      warning = FALSE, error = TRUE,
                      fig.height = 3)
library(tidyverse)
```

```{r, echo=F}
old <- theme_get()

theme_set(theme(panel.background = element_rect(fill = "#ededfb")))
```

# Preliminaries

- This file should be in `STAT240/homework/hw07` on your local computer.


# Problem 1

The weight of adult male grizzly bears in the continental United States is well approximated by a normal distribution with mean 510 pounds and standard deviation 45 pounds. The weight of adult female grizzly bears in the continental United States is well approximated by a normal distribution with mean 315 pounds and standard deviation 37 pounds.

Suppose a male grizzly bear that is 441 pounds is observed. What would be the approximate weight of a female grizzly bear with the same weight percentile as this male grizzly bear?

<span style="color:#5858d0">  The standardized score for the 441 pound male is $\frac{441-510}{45} = -1.533.$  Using the mean and standard deviation, we can convert this value to a weight of a female grizzly bear.  $-1.533(37) + 315 = 258.28$.  A male grizzly bear weighing 441 pounds corresponds to a female grizzly bear weighing about 258.28 pounds.  We can also do this with R. </span>

```{r, class.source="soln", class.output="soln"}
pnorm(441, 510, 45) %>%
  qnorm(mean = 315, sd = 37)
```


# Problem 2

The lifespan of a certain type of tire is approximately normal, with mean 39 and standard deviation 2.5 (units are in thousands of miles).
  
(a) What is the probability that a random tire will last longer than 40,000 miles?

<span style="color:#5858d0">  Use `pnorm` to find the probability above 40 on the original tire lifespan distribution.  Set `lower.tail = F` to find a probability in the upper tail. </span>

```{r, class.source="soln", class.output="soln"}
pnorm(40, 39, 2.5, lower.tail = F)
```

(b) What is the 95th percentile of tire lifespan?

<span style="color:#5858d0">  Use `qnorm` to find the value that has area 0.95 to the left on the tire distribution. </span>

```{r, class.source="soln", class.output="soln"}
qnorm(0.95, 39, 2.5)
```

(c) Take a random sample of 4 tires.  What is the probability that the average lifespan of the four tires will be greater than 40,000 miles?

<span style="color:#5858d0">  Now, we are working with the sampling distribution, $\bar{X}$.  This has distribution $N\Big(\mu, \frac{\sigma}{\sqrt{n}}\Big) = N(39, 2.5/\sqrt{4})$.  We need to repeat the above problems on this new normal distribution. </span>

```{r, class.source="soln", class.output="soln"}
pnorm(40, 39, 2.5/sqrt(4), lower.tail = F)
```

(d) What is the 95th percentile for the average lifespan of four tires?  

```{r, class.source="soln", class.output="soln"}
qnorm(0.95, 39, 2.5/sqrt(4))
```

(e) Explain why the answers to (a) and (b) are so different from the ansewrs to (c) and (d).

<span style="color:#5858d0">  We are more likely to see a single tire last longer than 40k miles when compared to the average lifespan.  The sampling distribution has less spread around the mean of 39, resulting in "tail" values being less likely.  Similarly, the 95th percentile of $\bar{X}$ is closer to 39 than the 95th percentile of the original distribution. </span>


# Problem 3

Suppose you are playing a coin flipping game with a friend, where you suspect the coin your friend provided is not a fair coin.  In fact, you think the probability the coin lands heads is less than 0.5.  To test this, you flip the coin 100 times and observe the coin lands heads 30 times.
  
(a) If you assume the coin is fair (i.e., the probability of the coin landing heads is 0.5), what is the probability of observing 30 heads or fewer, calculated using an exact model?

```{r, class.source="soln", class.output="soln"}
pbinom(30, 100, 0.5)
```

<span style="color:#5858d0">  This is a very small probability. </span>

(b) Calculate the previous probability, but use a normal approximation to achieve a numerical value. What is the error in this approximation?

<span style="color:#5858d0">  The binomial is approximated by a normal with mean $np = 50$ and standard deviation $\sqrt{np(1-p)} = \sqrt{25}$. </span>

```{r, class.source="soln", class.output="soln"}
pnorm(30, 50, sqrt(25))
```

<span style="color:#5858d0">  The probability is small and is similar to the exact probability in (a).  The difference between the exact and approximate probabilities is only $7.6\times 10^{-6}$. </span>

```{r, class.source="soln", class.output="soln"}
pbinom(30, 100, 0.5) - pnorm(30, 50, sqrt(25))
```


(c) How small would $p$ need to be (rounded to the nearest 0.01) for the probability of observing 30 or fewer heads to be greater than 0.05? *You could determine $p$ by trial and error, but there is also a quicker solution using `tibble()`.*

<span style="color:#5858d0">  Let's make a table of $P(X \le 30)$ for the different choices of $p$. </span>

```{r, class.source="soln", class.output="soln"}
prob3c <- tibble(n = 100,
                p = seq(0.01, 0.5, 0.01),
                p30 = pbinom(30, n, p)) %>% 
  filter(p30 >= 0.05) %>% 
  slice_max(p)

prob3c
```

<span style="color:#5858d0">  The probability of heads $p$ would need to be 0.38 or smaller. </span>


# Problem 4

The code below does the following: 

- Draw `n` points from a population called `pop`
- Calculate the mean of the `n` points
- Repeat this 10000 times to get a large number of sample means

```{r, eval = FALSE}
replicate(10000, mean(sample(pop, n, replace = T)))
```

Copy-paste and edit the line above to perform this operation three times with 10000 iterations each.  Do this with $n = 5$, $n = 10$, and $n = 50$. Use `right_skewed` below as your population, `pop`.

Then, make four histograms to compare the original population and the three sampling distributions.  What do you notice as $n$ increases?

```{r, class.source="soln", class.output="soln"}
right_skewed <- c(rep(0, 60), rep(1, 25), rep(2, 10), rep(3, 5))

n_5 <- replicate(10000, mean(sample(right_skewed, 5, replace = T)))
n_10 <- replicate(10000, mean(sample(right_skewed, 10, replace = T)))
n_50 <- replicate(10000, mean(sample(right_skewed, 50, replace = T)))

ggplot(data = NULL, aes(x = right_skewed)) + 
  geom_histogram() +
  labs(title = "Original Population")

ggplot(data = NULL, aes(x = n_5)) + 
  geom_histogram() +
  labs(title = "Sample Mean, n = 5, 10000 Iterations")

ggplot(data = NULL, aes(x = n_10)) + 
  geom_histogram() +
  labs(title = "Sample Mean, n = 10, 10000 Iterations")

ggplot(data = NULL, aes(x = n_50)) + 
  geom_histogram() +
  labs(title = "Sample Mean, n = 50, 10000 Iterations")
```

<span style="color:#5858d0"> For small $n$, the sampling distribution retains some of the right-skew of the original population.  As $n$ increases, the shape of the sampling distribution of the mean becomes less skewed, more symmetric, and more like a normal bell curve. </span>


# Problem 5

A 95% confidence interval for the true mean monthly rent in USD in Madison based on a random sample of 100 apartments is (943, 1024).  Briefly explain whether each of the following statements are true or false.

(a) About 95 percent of all rental prices in Madison are between 943 and 1024.

<span style="color:#5858d0"> This is false.  The confidence interval is a statement about the parameter (the mean of the population), not the values in the population itself. </span>

(b) About 95 percent of the 100 rental prices in this sample are between 943 and 1024.

<span style="color:#5858d0"> This is false, for a similar reason to part (a).  The interval is a statement about the sample mean, and if we wanted to, we could calculate the percentiles of our data directly without having to use statistics. </span>

(c) In repeated sampling, the method produces intervals that include the population mean in approximately 95% of samples. 

<span style="color:#5858d0"> This is true, and is a good technical interpretation of a confidence interval.  Every interval either covers the population value or does not, and the "95 percent" comes from the overall success rate of the procedure across multiple samples. </span>

(d) There is a 95% chance that the true mean monthly rent is between 943 and 1024.

<span style="color:#5858d0"> This is technically false, because we are assuming that the "true mean monthly rent" is a constant and therefore does not have probability.  It either falls within (943, 1024), or it does not. </span>

(e) Working with this same sample, we would expect a hypothesis test with significance level 0.05 to fail to reject a null hypothesis that the true mean monthly rent is 1000.

<span style="color:#5858d0"> This is true.  Because a 95% confidence interval contains the value 1000, a 5% level hypothesis test will not have sufficient evidence to reject the null value of 1000.  With either method, the data suggests that 1000 is a plausible guess for the mean monthly rent. </span>


# Problem 6

For each of the three prompts, explain which condition will result in a *narrower* confidence interval.  If the confidence level would not change, explain why.

- Having a larger confidence level (smaller alpha) versus having a smaller confidence level (larger alpha)

<span style="color:#5858d0"> Having a smaller confidence level (thus larger alpha) will result in a narrower interval.  In this case, we are sacrificing confidence for the sake of having a more precise interval.  If the interval is smaller, we are less confident that it successfully covers the actual parameter. </span>

- Having larger estimation error (a.k.a "sampling error") versus having smaller estimation error

<span style="color:#5858d0"> Having a smaller estimation error will result in a narrower interval.  When the statistic does a better job of estimating the parameter, we don't need our interval to be as wide. </span>

- Having a larger point estimate versus having a smaller point estimate

<span style="color:#5858d0"> The point estimate does not affect the confidence level, only the midpoint of the interval. </span>


# Problem 7

The code below calculates the Z critical value to build a 95% confidence interval.

(a) Edit the code to instead calculate the critical value for 98% confidence.

```{r, class.source="soln", class.output="soln"}
qnorm(0.975)

# 98% confidence: use the alpha/2 = 0.02/2 = 0.01 critical value
qnorm(0.99)
```

(b) Next, generalize this operation to any confidence level.  Uncomment and edit the code below to return the critical value for a (1-alpha) confidence interval for any choice of alpha.

```{r, class.source="soln", class.output="soln"}
# For example, a 90% CI
alpha <- 0.1

qnorm(1 - alpha/2)

# This will also work but it will give you a negative critical value

qnorm(alpha/2)
```

(c) What would be the critical value for a 100% confidence interval?

<span style="color:#5858d0"> To have perfect 100% confidence, the interval would need to cover the entire number line, and therefore the critical value would need to be infinity. </span>

```{r, class.source="soln", class.output="soln"}
qnorm(1 - 0/2)
```


# Problem 8

For Halloween, you have purchased a big bag of candy made up of equal amounts of KitKats, Hershey's, Almond Joys, and Reese's candy bars.

(a) A small child reaches in and pulls out three Reese's candy bars.  What is the probability that all three of their three candies were Reese's by random chance?  (Assume candy bar draws are independent and all have equal probability of being a Reese's.)

<span style="color:#5858d0"> Under these assumptions, the number of Reese's candies picked out of three is Binom(3, 0.25).  The probability of getting all 3 Reese's by chance is 0.0156, which is not very likely, but still completely plausible. </span>

```{r, class.source="soln", class.output="soln"}
pbinom(2, 3, 0.25, lower.tail = F)
```

(b) A different small child reaches in and takes seven Reese's candy bars and one other candy bar.  What is the probability that seven or more of their eight candies were Reese's by random chance?

<span style="color:#5858d0"> Now, we are working with Binom(8, 0.25).  The probability is only 0.0004, which is much less likely than three out of three Reese's bars above. </span>

```{r, class.source="soln", class.output="soln"}
pbinom(6, 8, 0.25, lower.tail = F)
```

(c) Intuitively, which of the two situations is more "suspicious"?  Do the probabilities match your intuition?

<span style="color:#5858d0"> I am more suspicious of the child that took more candy but nonetheless has almost entirely Reese's.  When they are taking a bigger sample of candy, it becomes an even bigger concidence to have randomly picked the same type of candy for 7 out of 8 pulls.  This is reflected in the fact that the probability in (b) is much smaller than the probability in (a). </span>




