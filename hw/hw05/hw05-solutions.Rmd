---
title: "Homework 5"
output: html_document
---

```{css, echo = F}
.soln {
background-color: #E6E6FA;
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
                      warning = FALSE, error = TRUE,
                      fig.height = 3)
library(tidyverse)
```

# Preliminaries

- This file should be in `STAT240/homework/hw05` on your local computer.
- Download `Cameron_Lectures_SP24.csv` to `STAT240/data`.


# Problem 1

In a certain soccer league, there are a total of 1-7 goals per game, with most games having 2 or fewer total goals.

The distribution of the number of goals is shown below, with the probability of four total goals being scored removed.

```{r}
goal_vals <- 1:7
goal_probs <- c(0.335, 0.236, 0.231, NA, 
                0.066, 0.018, 0.012)

goals <- tibble(goal_vals, goal_probs)

goal_distribution <- ggplot(goals, aes(x = goal_vals, y = goal_probs)) +
  geom_segment(aes(xend = goal_vals, yend = 0), color = "blue", size=2) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = goal_vals) +
  ylab("P(X=x)") +
  ggtitle("Distribution of Total Goals per Game") +
  
  annotate("text", x = 4, y = 0.1, label = "?", size = 15, color = "blue")

goal_distribution
```

Write code with either base R or dplyr to manually compute the value of the missing $P(\text{Goals} = 4)$. Save that single value as `p4`.

On a separate line, let the value of `p4` be printed as output in your knitted file.

```{r, class.source="soln", class.output="soln"}
p4 <- 1 - sum(goal_probs, na.rm = T)
p4
```


# Problem 2

The following code inserts the missing `p4` into the missing slot.  For parts (a)-(c), you can use R and `goal_vals` and `goal_probs` for your calculations.

```{r}
goal_vals <- 1:7
goal_probs <- c(0.335, 0.236, 0.231, p4, 
                0.066, 0.018, 0.012)
```

(a) What is the mean of this distribution?

```{r, class.source="soln", class.output="soln"}
goals_mean <- sum(goal_vals*goal_probs)
goals_mean
```

(b) What is the variance of this distribution?

```{r, class.source="soln", class.output="soln"}
goals_var <- sum((goal_vals - goals_mean)^2 * goal_probs)
goals_var
```

(c) What is the standard deviation of this distribution?

```{r, class.source="soln", class.output="soln"}
sqrt(goals_var)
```

(d) Let $\mu$ refer to the mean/expected value you calculated in (a). For each of the following interpretations of $\mu$, identify whether are correct or incorrect, and briefly explain.

"Most games played will end up with $\mu$ total goals scored."

<span style="color:#5858d0"> This is incorrect.  The mean refers to a "typical" value of a random process, which may not be the most likely value.  In fact, since the mean of this RV is a decimal value, it is impossible for any individual game to have exactly $\mu$ goals scored. </span>

"In an infinitely big sample of games, the long-run average number of goals would be $\mu$."

<span style="color:#5858d0"> This is a correct interpretation of the mean or expected value. The values and probabilities of the random variable represent a complete or infinite population of possible games. </span>

"Half of games have fewer than $\mu$ goals and half of them have more than $\mu$ goals."

<span style="color:#5858d0"> This is the definition of the median, not the mean. In the case of an asymmetric probability distribution, the median and mean will be different.  For this random variable, most of the probability mass (P(1) + P(2)) is below $\mu$. </span>


# Problem 3

For each of the real life scenarios described below, state whether you would treat the random variable as discrete or continuous and briefly explain why.

The random process for each of these random variables is: "Your professor holds a STAT 240 lecture."

(a) The number of students who attend a given lecture.

<span style="color:#5858d0"> This is a discrete random variable; there can only be whole numbers of students. If your lecture section is quite large, you might choose to treat it as continuous for convenience, but it is technically discrete. </span>

(b) The average age of the students who attend a given lecture. (Treat the age of an individual student as a whole number of years, e.g. 18, 19, 20, 21.)

<span style="color:#5858d0"> This must be treated as a continuous random variable. The average could be any decimal number (18.6, 19.7777, et cetera) even if you consider the individual students' ages in years as whole numbers. </span>

(c) The length, in seconds, of the lecture recording for a specific lecture. Pretend you only know the length to the nearest round second.

<span style="color:#5858d0"> We would almost certainly treat this as a continuous variable. While it is technically discrete, there are so many possibilities that it doesn't make sense to care about each individual count. Furthermore, we know that despite measurement only going to the nearest second, it actually could be measured to further precision, meaning continuous makes the most sense here. </span>


# Problem 4

The `lectures` dataset contains information on the length in decimal minutes (not seconds) of Cameron's Spring 2024 STAT 240 lectures, and information on the outfits he wore.

```{r}
lectures <- read_csv("../../data/Cameron_Lectures_SP24.csv")
```

Create a histogram of `total_minutes`.

Incorporate the following customizations:

- The bins should be of width 1, and have boundaries on each of the whole numbers. E.g., there should be a bin from 47 to 48, 48 to 49, et cetera.

- Use a consistent color scheme for the interior and exterior of each bar that is the same for every bar.

- If ggplot does not do it by default, make sure the x axis labels are each of the whole numbers 47 through 52.

```{r, echo = F}
theme_set(theme(panel.background = element_rect(fill = "#ededfb")))
```


```{r, class.source="soln", class.output="soln"}
ggplot(lectures, aes(total_minutes)) +
  geom_histogram(binwidth = 1, boundary = 50, color = "black", fill = "dodgerblue") +
  scale_x_continuous(breaks = 47:52)
```


# Problem 5

Our goal in this problem is to calculate the percentages associated with each of the five bars in the above histogram.

First, create a new variable called `base_minutes` by "truncating" `total_minutes` by using the `floor()` function.  This is effectively just cutting the decimal off, which is different than rounding; 49.4, 49.9, 50.1, 50.8 will become 49, 49, 50, 50.

Then, create a dataframe with one row for each different value of `base_minutes`, and a column `n` for how many times that value of `base_minutes` occurs. 

Finally, create a `percent` variable by dividing `n` by the total number of lectures.

Let this dataframe print as output, no need to save it in a new variable name.

```{r, class.source="soln", class.output="soln"}
lectures %>% 
  mutate(base_minutes = floor(total_minutes)) %>% 
  count(base_minutes) %>% 
  mutate(percent = n/sum(n))
```

You should determine that 55.3% of Cameron's Spring 2024 lectures were 50 minutes long (plus extra seconds we do not care about).


# Problem 6

(a) Consider an upcoming, future lecture of Cameron's that has not happened yet.  Is it valid to say that the future lecture has a 55.3% chance of being 50 minutes + left-over seconds long? Why or why not?

<span style="color:#5858d0">  No, it is not valid. 55.3% comes from Cameron's Spring 2024 lectures, and is not necessarily applicable to his future lectures. For example, perhaps Cameron has changed his slides or found more concise ways of explaining certain concepts. </span>

(b) Consider selecting a random lecture from Cameron's set of existing Spring 2024 recordings.  Is it valid to say that the randomly selected lecture has a 55.3% chance of being 50 minutes + left-over seconds long?** Why or why not?

<span style="color:#5858d0">  Yes, that is valid. Drawing from the entire SP24 set obeys the population's distribution, which dictates the 55.3% probability. </span>


# Problem 7

(a) Create and print a table of how often Cameron wore each `top_color` in `lectures`, with percentages included like Problem 5.

```{r, class.source="soln", class.output="soln"}
lectures %>% 
  count(top_color) %>% 
  mutate(percent = n/sum(n))
```

You should find that Cameron wore a navy colored shirt in 36.8% of SP24 lectures.

(b) Is it valid to guess that approximately 36.8% of all Cameron's shirts he owns are navy-colored? Briefly explain your reasoning.

<span style="color:#5858d0"> No. The choice of which shirt to wear to lecture may not be a random selection from the set of all his shirts. It is possible that, for example, only 20% of his shirts are navy, but he likes those shirts more than others, and is therefore more likely to pick them. </span>

<span style="color:#5858d0"> Another way to think about this; if you accept that guess above, you also accept the guess that approximately 0% of Cameron's shirts are green, yellow, brown, purple, et cetera, which is more obviously not a valid conclusion. </span>


# Problem 8

Your friend Kevin has started a new website called HowManyCheeseCurdsCanKevinEat.com and decides to model the number of daily users as a continuous distribution based on an expected value of 3.87 users.

A picture of the model, with values 0 and 5 highlighted, can be found in `hw5p8.png`.

(a) Based on the picture of the model, estimate the probability of the website having less than 5 users on a given day.  Does this seem reasonable?

<span style="color:#5858d0"> Based on the area under the curve of the model, the probability of having less than 5 users on a given day is about 70%.  This makes sense if we assume that Kevin's website is not very well-known. </span>

(b) Based on the picture of the model, estimate the probability of the website having less than 0 users on a given day.  Does this seem reasonable?

<span style="color:#5858d0"> Based on the area under the curve of the model, the probability of having less than 0 users on a given day is about 10%. This does not make sense, because it is impossible to have fewer than 0 users. </span>

(c) Explain why the number of daily users of HowManyCheeseCurdsCanKevinEat.com would be better modeled by a discrete variable.

<span style="color:#5858d0"> Since there is a relatively small number of daily users, and 'users' is a discrete process, it would make more sense to use a discrete random variable that has individual probabilities for each number of possible daily users. </span>

(d) Think of a different website for which "number of daily users" could be reasonably modeled as a continuous variable.  How does this context differ from Kevin's website?

<span style="color:#5858d0"> A website like google.com has over a billion users per day, and so there are many many possibilities for the value of 'daily uers'. The magnitude of the number of Google users is much bigger than the number of users for Kevin's website, so while it is still technically discrete, it appears to be approximately continuous. </span>












